# π”„ ν΄λΌμ΄μ–ΈνΈ μλ™ μ—…λ°μ΄νΈ μ‹μ¤ν…

μ›Ήμ†μΌ“μ„ ν†µν• μ‹¤μ‹κ°„ ν΄λΌμ΄μ–ΈνΈ μλ™ μƒλ΅κ³ μΉ¨ μ‹μ¤ν…μ…λ‹λ‹¤.

## π€ κΈ°λ¥

- β… **μ‹¤μ‹κ°„ μ•λ¦Ό**: μƒ λ²„μ „ λ°°ν¬ μ‹ μ¦‰μ‹ λ¨λ“  μ ‘μ† μ¤‘μΈ ν΄λΌμ΄μ–ΈνΈμ—κ² μ•λ¦Ό
- β… **μλ™ μƒλ΅κ³ μΉ¨**: λ²„μ „ λ¶μΌμΉ μ‹ μλ™μΌλ΅ νμ΄μ§€ μƒλ΅κ³ μΉ¨
- β… **μ‚¬μ©μ μ„ νƒκ¶**: μ—…λ°μ΄νΈ μ•λ¦Ό μ‹ μ‚¬μ©μκ°€ μƒλ΅κ³ μΉ¨ μ‹μ  μ„ νƒ κ°€λ¥
- β… **κ΄€λ¦¬μ μ „μ©**: κ΄€λ¦¬μλ§ μ—…λ°μ΄νΈ μ•λ¦Όμ„ λ³΄λ‚Ό μ μμ
- β… **λ²„μ „ μ¶”μ **: λ΅μ»¬μ¤ν† λ¦¬μ§€μ— λ²„μ „ μ •λ³΄ μ €μ¥μΌλ΅ μ¤‘λ³µ μ•λ¦Ό λ°©μ§€

## π“‹ κµ¬ν„λ κΈ°λ¥

### μ„λ²„ μΈ΅ (server/src/index.js)

1. **λ²„μ „ κ΄€λ¦¬ μ‹μ¤ν…**
   ```javascript
   let currentBuildVersion = process.env.BUILD_VERSION || Date.now().toString();
   ```

2. **μ—…λ°μ΄νΈ μ•λ¦Ό ν•¨μ**
   ```javascript
   function notifyClientUpdate(newVersion) {
     io.emit('app:update-available', { 
       version: newVersion,
       message: 'μƒλ΅μ΄ λ²„μ „μ΄ λ°°ν¬λμ—μµλ‹λ‹¤...',
       timestamp: Date.now()
     });
   }
   ```

3. **κ΄€λ¦¬μ API μ—”λ“ν¬μΈνΈ**
   ```
   POST /api/admin/notify-update
   ```

### ν΄λΌμ΄μ–ΈνΈ μΈ΅ (client/src/App.jsx)

1. **λ²„μ „ μ²΄ν¬ λ΅μ§**
   - μ ‘μ† μ‹ μ„λ²„μ—μ„ ν„μ¬ λ²„μ „ μμ‹ 
   - λ΅μ»¬ λ²„μ „κ³Ό λΉ„κµν•μ—¬ λ¶μΌμΉ μ‹ μλ™ μƒλ΅κ³ μΉ¨

2. **μ‹¤μ‹κ°„ μ—…λ°μ΄νΈ μ•λ¦Ό**
   - μ‚¬μ©μμ—κ² ν™•μΈ λ€ν™”μƒμ ν‘μ‹
   - κ±°λ¶€ μ‹ λ‹¤μ νμ΄μ§€ μ΄λ™ μ‹ μƒλ΅κ³ μΉ¨

## π› οΈ μ‚¬μ© λ°©λ²•

### 1. κ΄€λ¦¬μ ν† ν° μ„¤μ •

`build_and_notify.bat` νμΌμ—μ„ κ΄€λ¦¬μ JWT ν† ν°μ„ μ„¤μ •ν•μ„Έμ”:

```batch
set ADMIN_TOKEN=YOUR_ADMIN_JWT_TOKEN_HERE
```

### 2. λΉλ“ λ° λ°°ν¬

```cmd
build_and_notify.bat
```

λλ” μλ™μΌλ΅:

```cmd
# 1. ν΄λΌμ΄μ–ΈνΈ λΉλ“
cd client
npm run build

# 2. μ—…λ°μ΄νΈ μ•λ¦Ό μ „μ†΅
curl -X POST http://localhost:4000/api/admin/notify-update \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -d '{"version": "20241201_143000", "message": "μƒλ΅μ΄ λ²„μ „μ΄ λ°°ν¬λμ—μµλ‹λ‹¤."}'
```

### 3. ν™κ²½ λ³€μ μ„¤μ • (μ„ νƒμ‚¬ν•­)

μ„λ²„ μ‹μ‘ μ‹ λΉλ“ λ²„μ „μ„ ν™κ²½ λ³€μλ΅ μ„¤μ •:

```cmd
set BUILD_VERSION=20241201_143000
npm start
```

## π”§ API μ‚¬μ©λ²•

### μ—…λ°μ΄νΈ μ•λ¦Ό μ „μ†΅

**μ”μ²­:**
```http
POST /api/admin/notify-update
Authorization: Bearer {JWT_TOKEN}
Content-Type: application/json

{
  "version": "20241201_143000",
  "message": "μƒλ΅μ΄ λ²„μ „μ΄ λ°°ν¬λμ—μµλ‹λ‹¤. μ μ‹ ν›„ μλ™μΌλ΅ μƒλ΅κ³ μΉ¨λ©λ‹λ‹¤."
}
```

**μ‘λ‹µ:**
```json
{
  "success": true,
  "version": "20241201_143000",
  "message": "μƒλ΅μ΄ λ²„μ „μ΄ λ°°ν¬λμ—μµλ‹λ‹¤...",
  "connectedClients": 15,
  "timestamp": 1701423000000
}
```

## π― λ™μ‘ νλ¦„

1. **κ΄€λ¦¬μκ°€ μƒ λ²„μ „ λ°°ν¬**
   - `build_and_notify.bat` μ‹¤ν–‰
   - ν΄λΌμ΄μ–ΈνΈ λΉλ“ μ™„λ£
   - API νΈμ¶λ΅ μ—…λ°μ΄νΈ μ•λ¦Ό μ „μ†΅

2. **μ„λ²„μ—μ„ μ•λ¦Ό λΈλ΅λ“μΊμ¤νΈ**
   - λ¨λ“  μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈμ—κ² `app:update-available` μ΄λ²¤νΈ μ „μ†΅
   - μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈ μ λ΅κΉ…

3. **ν΄λΌμ΄μ–ΈνΈμ—μ„ μ•λ¦Ό μμ‹ **
   - μ‚¬μ©μμ—κ² ν™•μΈ λ€ν™”μƒμ ν‘μ‹
   - μΉμΈ μ‹ μ¦‰μ‹ μƒλ΅κ³ μΉ¨
   - κ±°λ¶€ μ‹ λ‹¤μ νμ΄μ§€ μ΄λ™ μ‹ μƒλ΅κ³ μΉ¨

4. **λ²„μ „ μ²΄ν¬**
   - ν΄λΌμ΄μ–ΈνΈ μ ‘μ† μ‹ μ„λ²„μ—μ„ ν„μ¬ λ²„μ „ μ „μ†΅
   - λ΅μ»¬ λ²„μ „κ³Ό λΉ„κµν•μ—¬ λ¶μΌμΉ μ‹ μλ™ μƒλ΅κ³ μΉ¨

## π”’ λ³΄μ•

- β… κ΄€λ¦¬μ κ¶ν• ν™•μΈ (JWT ν† ν° + isAdmin μ²΄ν¬)
- β… API μ”μ²­ λ΅κΉ…
- β… μλ»λ μ”μ²­ μ°¨λ‹¨

## π“ λ΅κ·Έ μμ‹

```
π“± ν„μ¬ μ•± λ²„μ „: 20241201_143000
π”‘ [ADMIN] Update notification request: { version: '20241201_143000', adminUsername: 'admin' }
π“Ά μƒ λ²„μ „ λ°°ν¬ μ•λ¦Ό μ „μ†΅: 20241201_143000 (μ—°κ²°λ ν΄λΌμ΄μ–ΈνΈ: 15κ°)
β… [ADMIN] Update notification sent by admin: 20241201_143000
```

## π¨ μ£Όμμ‚¬ν•­

1. **κ΄€λ¦¬μ ν† ν° λ³΄μ•**: JWT ν† ν°μ„ μ•μ „ν•κ² λ³΄κ΄€ν•μ„Έμ”
2. **μ„λ²„ μ‹¤ν–‰ ν™•μΈ**: λ°°ν¬ μ „ μ„λ²„κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€ ν™•μΈν•μ„Έμ”
3. **λ„¤νΈμ›ν¬ μ—°κ²°**: curl λ…λ Ήμ–΄κ°€ μ •μƒ μ‘λ™ν•λ”μ§€ ν™•μΈν•μ„Έμ”
4. **λΈλΌμ°μ € νΈν™μ„±**: λ¨λ“  μ£Όμ” λΈλΌμ°μ €μ—μ„ ν…μ¤νΈν•μ„Έμ”

## π”„ ν–¥ν›„ κ°μ„  μ‚¬ν•­

- [ ] μ°μ•„ν• μƒλ΅κ³ μΉ¨ (μ‘μ—… μ¤‘μΈ μ‚¬μ©μ κ³ λ ¤)
- [ ] μ—…λ°μ΄νΈ μ§„ν–‰λ¥  ν‘μ‹
- [ ] λ΅¤λ°± κΈ°λ¥
- [ ] μ—…λ°μ΄νΈ νμ¤ν† λ¦¬ κ΄€λ¦¬

